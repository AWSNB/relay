



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
        <meta name="author" content="Sentry">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.6.2">
    
    
      
        <title>Metrics - Sentry Relay</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.adb8469c.css">
      
      
    
    
      <script src="../assets/javascripts/modernizr.86422ebf.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="https://unpkg.com/mermaid@7.1.2/dist/mermaid.css">
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#metrics" tabindex="0" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="Sentry Relay" aria-label="Sentry Relay" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Sentry Relay
            </span>
            <span class="md-header-nav__topic">
              
                Metrics
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" aria-label="search" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/getsentry/relay/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href=".." title="Sentry Relay" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Sentry Relay
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/getsentry/relay/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../options/" title="Configuration Options" class="md-nav__link">
      Configuration Options
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../project-config/" title="Project Configuration" class="md-nav__link">
      Project Configuration
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Metrics
      </label>
    
    <a href="./" title="Metrics" class="md-nav__link md-nav__link--active">
      Metrics
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#relayhistograms" class="md-nav__link">
    RelayHistograms
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#eventqueue_sizepct" class="md-nav__link">
    event.queue_size.pct
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eventqueue_size" class="md-nav__link">
    event.queue_size
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eventsize_bytesraw" class="md-nav__link">
    event.size_bytes.raw
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eventsize_bytesuncompressed" class="md-nav__link">
    event.size_bytes.uncompressed
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project_statepending" class="md-nav__link">
    project_state.pending
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project_staterequestbatch_size" class="md-nav__link">
    project_state.request.batch_size
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project_statereceived" class="md-nav__link">
    project_state.received
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project_cachesize" class="md-nav__link">
    project_cache.size
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#relaytimers" class="md-nav__link">
    RelayTimers
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#event_processingdeserialize" class="md-nav__link">
    event_processing.deserialize
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#event_processingprocess" class="md-nav__link">
    event_processing.process
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#event_processingfiltering" class="md-nav__link">
    event_processing.filtering
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#event_processingrate_limiting" class="md-nav__link">
    event_processing.rate_limiting
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#event_processingpii" class="md-nav__link">
    event_processing.pii
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#event_processingserialization" class="md-nav__link">
    event_processing.serialization
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eventwait_time" class="md-nav__link">
    event.wait_time
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eventprocessing_time" class="md-nav__link">
    event.processing_time
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eventtotal_time" class="md-nav__link">
    event.total_time
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project_stateevictionduration" class="md-nav__link">
    project_state.eviction.duration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project_staterequestduration" class="md-nav__link">
    project_state.request.duration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project_idrequestduration" class="md-nav__link">
    project_id.request.duration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#requestsduration" class="md-nav__link">
    requests.duration
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#relaysets" class="md-nav__link">
    RelaySets
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#unique_projects" class="md-nav__link">
    unique_projects
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#relaycounters" class="md-nav__link">
    RelayCounters
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#eventaccepted" class="md-nav__link">
    event.accepted
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eventrejected" class="md-nav__link">
    event.rejected
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eventsoutcomes" class="md-nav__link">
    events.outcomes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project_stateget" class="md-nav__link">
    project_state.get
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project_staterequest" class="md-nav__link">
    project_state.request
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project_cachehit" class="md-nav__link">
    project_cache.hit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project_cachemiss" class="md-nav__link">
    project_cache.miss
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project_idrequest" class="md-nav__link">
    project_id.request
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serverstarting" class="md-nav__link">
    server.starting
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#processingeventproduced" class="md-nav__link">
    processing.event.produced
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eventprotocol" class="md-nav__link">
    event.protocol
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#requests" class="md-nav__link">
    requests
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#responsesstatus_codes" class="md-nav__link">
    responses.status_codes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project_cacheeviction" class="md-nav__link">
    project_cache.eviction
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      PII and datascrubbing
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        PII and datascrubbing
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../pii-config/" title="PII Configuration" class="md-nav__link">
      PII Configuration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../pii-config/types/" title="PII Rule Types" class="md-nav__link">
      PII Rule Types
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../pii-config/methods/" title="PII Redaction Methods" class="md-nav__link">
      PII Redaction Methods
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../pii-config/selectors/" title="PII Selectors" class="md-nav__link">
      PII Selectors
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Architecture
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Architecture
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../architecture/" title="Architecture" class="md-nav__link">
      Architecture
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../architecture/actors/" title="Actors" class="md-nav__link">
      Actors
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../architecture/ingest-event-path/" title="Path of an Event through Relay" class="md-nav__link">
      Path of an Event through Relay
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../architecture/project-configuration/" title="Project configuration" class="md-nav__link">
      Project configuration
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../event-schema/" title="Event schema" class="md-nav__link">
      Event schema
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#relayhistograms" class="md-nav__link">
    RelayHistograms
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#eventqueue_sizepct" class="md-nav__link">
    event.queue_size.pct
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eventqueue_size" class="md-nav__link">
    event.queue_size
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eventsize_bytesraw" class="md-nav__link">
    event.size_bytes.raw
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eventsize_bytesuncompressed" class="md-nav__link">
    event.size_bytes.uncompressed
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project_statepending" class="md-nav__link">
    project_state.pending
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project_staterequestbatch_size" class="md-nav__link">
    project_state.request.batch_size
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project_statereceived" class="md-nav__link">
    project_state.received
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project_cachesize" class="md-nav__link">
    project_cache.size
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#relaytimers" class="md-nav__link">
    RelayTimers
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#event_processingdeserialize" class="md-nav__link">
    event_processing.deserialize
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#event_processingprocess" class="md-nav__link">
    event_processing.process
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#event_processingfiltering" class="md-nav__link">
    event_processing.filtering
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#event_processingrate_limiting" class="md-nav__link">
    event_processing.rate_limiting
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#event_processingpii" class="md-nav__link">
    event_processing.pii
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#event_processingserialization" class="md-nav__link">
    event_processing.serialization
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eventwait_time" class="md-nav__link">
    event.wait_time
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eventprocessing_time" class="md-nav__link">
    event.processing_time
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eventtotal_time" class="md-nav__link">
    event.total_time
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project_stateevictionduration" class="md-nav__link">
    project_state.eviction.duration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project_staterequestduration" class="md-nav__link">
    project_state.request.duration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project_idrequestduration" class="md-nav__link">
    project_id.request.duration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#requestsduration" class="md-nav__link">
    requests.duration
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#relaysets" class="md-nav__link">
    RelaySets
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#unique_projects" class="md-nav__link">
    unique_projects
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#relaycounters" class="md-nav__link">
    RelayCounters
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#eventaccepted" class="md-nav__link">
    event.accepted
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eventrejected" class="md-nav__link">
    event.rejected
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eventsoutcomes" class="md-nav__link">
    events.outcomes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project_stateget" class="md-nav__link">
    project_state.get
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project_staterequest" class="md-nav__link">
    project_state.request
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project_cachehit" class="md-nav__link">
    project_cache.hit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project_cachemiss" class="md-nav__link">
    project_cache.miss
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project_idrequest" class="md-nav__link">
    project_id.request
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serverstarting" class="md-nav__link">
    server.starting
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#processingeventproduced" class="md-nav__link">
    processing.event.produced
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eventprotocol" class="md-nav__link">
    event.protocol
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#requests" class="md-nav__link">
    requests
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#responsesstatus_codes" class="md-nav__link">
    responses.status_codes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project_cacheeviction" class="md-nav__link">
    project_cache.eviction
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/getsentry/relay/edit/master/docs/metrics.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="metrics">Metrics</h1>
<p>Relay emits statsd metrics in order to allow its monitoring.</p>
<h2 id="relayhistograms">RelayHistograms</h2>
<p>Histogram metrics used by Relay.</p>
<h3 id="eventqueue_sizepct"><code>event.queue_size.pct</code></h3>
<p>The metric is referred in code as: <code>RelayHistograms::EventQueueSizePct</code>.</p>
<p>The number of events in the queue as a percentage of the maximum number of events
that can be stored in the queue ( 0 ... the queue is empty, 1 ... the queue is full
and no additional events can be added).</p>
<h3 id="eventqueue_size"><code>event.queue_size</code></h3>
<p>The metric is referred in code as: <code>RelayHistograms::EventQueueSize</code>.</p>
<p>The number of events in the queue. The event queue represents the events that are being
processed at a particular time in Relay. Once a request is received the event has
some preliminary (quick) processing to determine if it can be processed or it is
rejected. Once this determination has been done the http request that
created the event terminates and, if the request is to be further processed,
the event enters a queue ( a virtual queue, the event is kept in a future that
will resolve at some point in time).
Once the event finishes processing and is sent downstream (i.e. the future is
resolved and the event leaves relay) the event is considered handled and it
leaves the queue ( the queue size is decremented).</p>
<h3 id="eventsize_bytesraw"><code>event.size_bytes.raw</code></h3>
<p>The metric is referred in code as: <code>RelayHistograms::EventSizeBytesRaw</code>.</p>
<p>The event size as seen by Relay after it is extracted from a request.</p>
<h3 id="eventsize_bytesuncompressed"><code>event.size_bytes.uncompressed</code></h3>
<p>The metric is referred in code as: <code>RelayHistograms::EventSizeBytesUncompressed</code>.</p>
<p>The event size as seen by Relay after it has been decompressed and decoded (e.g. from Base64).</p>
<h3 id="project_statepending"><code>project_state.pending</code></h3>
<p>The metric is referred in code as: <code>RelayHistograms::ProjectStatePending</code>.</p>
<p>Number of projects in the ProjectCache that are waiting for their state to be updated.</p>
<h3 id="project_staterequestbatch_size"><code>project_state.request.batch_size</code></h3>
<p>The metric is referred in code as: <code>RelayHistograms::ProjectStateRequestBatchSize</code>.</p>
<p>Number of project state requested from the Upstream for the current batch request.</p>
<h3 id="project_statereceived"><code>project_state.received</code></h3>
<p>The metric is referred in code as: <code>RelayHistograms::ProjectStateReceived</code>.</p>
<p>Number of project states received from the Upstream for the current batch request.</p>
<h3 id="project_cachesize"><code>project_cache.size</code></h3>
<p>The metric is referred in code as: <code>RelayHistograms::ProjectStateCacheSize</code>.</p>
<p>Number of project states currently held in the ProjectState cache.</p>
<h2 id="relaytimers">RelayTimers</h2>
<p>Timer metrics used by Relay</p>
<h3 id="event_processingdeserialize"><code>event_processing.deserialize</code></h3>
<p>The metric is referred in code as: <code>RelayTimers::EventProcessingDeserialize</code>.</p>
<p>The time spent deserializing an event from a JSON byte array into the native data structure
on which Relay operates.</p>
<h3 id="event_processingprocess"><code>event_processing.process</code></h3>
<p><strong>Note</strong>: This metric is emitted only when Relay is built with the <code>processing</code> feature.</p>
<p>The metric is referred in code as: <code>RelayTimers::EventProcessingProcess</code>.</p>
<p>Time spent running event processors on an event.
Event processing happens before filtering.</p>
<h3 id="event_processingfiltering"><code>event_processing.filtering</code></h3>
<p><strong>Note</strong>: This metric is emitted only when Relay is built with the <code>processing</code> feature.</p>
<p>The metric is referred in code as: <code>RelayTimers::EventProcessingFiltering</code>.</p>
<p>Time spent running filtering on an event.</p>
<h3 id="event_processingrate_limiting"><code>event_processing.rate_limiting</code></h3>
<p><strong>Note</strong>: This metric is emitted only when Relay is built with the <code>processing</code> feature.</p>
<p>The metric is referred in code as: <code>RelayTimers::EventProcessingRateLimiting</code>.</p>
<p>Time spent checking for rate limits in Redis.
Note that not all events are checked against Redis. After an event is rate limited
for period A, any event using the same key coming during period A will be automatically
rate limited without checking against Redis (the event will be simply discarded without
being placed in the processing queue).</p>
<h3 id="event_processingpii"><code>event_processing.pii</code></h3>
<p>The metric is referred in code as: <code>RelayTimers::EventProcessingPii</code>.</p>
<p>Time spent in data scrubbing for the current event.</p>
<h3 id="event_processingserialization"><code>event_processing.serialization</code></h3>
<p>The metric is referred in code as: <code>RelayTimers::EventProcessingSerialization</code>.</p>
<p>Time spent converting the event from an Annotated<Event> into a String containing the JSON
representation of the event.</p>
<h3 id="eventwait_time"><code>event.wait_time</code></h3>
<p>The metric is referred in code as: <code>RelayTimers::EventWaitTime</code>.</p>
<p>Represents the time spent between receiving the event in Relay (i.e. beginning of the
request handling) up to the time before starting synchronous processing in the EventProcessor.</p>
<h3 id="eventprocessing_time"><code>event.processing_time</code></h3>
<p>The metric is referred in code as: <code>RelayTimers::EventProcessingTime</code>.</p>
<p>This is the time the event spends in the EventProcessor (i.e. the sync processing of the
event).
The time spent in synchronous event processing.</p>
<p>This timing covers the end-to-end processing in the CPU pool and comprises:</p>
<ul>
<li><code>event_processing.deserialize</code></li>
<li><code>event_processing.pii</code></li>
<li><code>event_processing.serialization</code></li>
</ul>
<p>With Relay in processing mode, this includes the following additional timings:</p>
<ul>
<li><code>event_processing.process</code></li>
<li><code>event_processing.filtering</code></li>
<li><code>event_processing.rate_limiting</code></li>
</ul>
<h3 id="eventtotal_time"><code>event.total_time</code></h3>
<p>The metric is referred in code as: <code>RelayTimers::EventTotalTime</code>.</p>
<p>The total time an event spends in Relay from the time it is received until it finishes
processing.</p>
<h3 id="project_stateevictionduration"><code>project_state.eviction.duration</code></h3>
<p>The metric is referred in code as: <code>RelayTimers::ProjectStateEvictionDuration</code>.</p>
<p>The total time spent during <code>ProjectCache.fetch_states</code> in which eviction of outdated
projects happens.</p>
<h3 id="project_staterequestduration"><code>project_state.request.duration</code></h3>
<p>The metric is referred in code as: <code>RelayTimers::ProjectStateRequestDuration</code>.</p>
<p>The total time spent during <code>ProjectCache.fetch_states</code> spent waiting for all ProjectState
requests to resolve. During a fetch_states request, we pick up to max_num_requests *
max_num_project_states_per_request projects that need their state updated and batch
them into max_num_requests requests. This metric represents the time spent from issuing
the first request until all requests are finished.</p>
<h3 id="project_idrequestduration"><code>project_id.request.duration</code></h3>
<p>The metric is referred in code as: <code>RelayTimers::ProjectIdRequestDuration</code>.</p>
<p>The total time spent getting the project id from upstream.
<strong>Note</strong> that ProjectIdRequests happen only for the legacy
endpoint that does not specify the project id in the url, for the new endpoints the
project id is extracted from the url path. Only projects with the id not already fetched
are counted.
The project id is only fetched once and it is not refreshed.</p>
<h3 id="requestsduration"><code>requests.duration</code></h3>
<p>The metric is referred in code as: <code>RelayTimers::RequestsDuration</code>.</p>
<p>The total duration of a request as seen from Relay from the moment the request is
received until a http result is returned. Note that this does <strong>not</strong> represent the
total duration for processing an event. Requests for events that are not immediately
rejected ( because the project has hit a rate limit) are scheduled for processing at
a latter time and an HTTP OK (200) is returned.</p>
<h2 id="relaysets">RelaySets</h2>
<p>Set metrics used by Relay</p>
<h3 id="unique_projects"><code>unique_projects</code></h3>
<p>The metric is referred in code as: <code>RelaySets::UniqueProjects</code>.</p>
<p>Represents the number of active projects in the current slice of time</p>
<h2 id="relaycounters">RelayCounters</h2>
<p>Counter metrics used by Relay</p>
<h3 id="eventaccepted"><code>event.accepted</code></h3>
<p>The metric is referred in code as: <code>RelayCounters::EventAccepted</code>.</p>
<p>Number of events accepted in the current time slot. This represents events that
have successfully passed rate limits, filters and have been successfully handled.</p>
<h3 id="eventrejected"><code>event.rejected</code></h3>
<p>The metric is referred in code as: <code>RelayCounters::EventRejected</code>.</p>
<p>Number of events rejected in the current time slot. This includes events being rejected
because they are malformed or any other error during processing (including filtered
events, discarded events and rate limited events).</p>
<h3 id="eventsoutcomes"><code>events.outcomes</code></h3>
<p><strong>Note</strong>: This metric is emitted only when Relay is built with the <code>processing</code> feature.</p>
<p>The metric is referred in code as: <code>RelayCounters::EventOutcomes</code>.</p>
<p>Represents a group of counters, implemented with using tags. The following tags are
present for each event outcome:</p>
<ul>
<li><code>outcome</code> which is an <code>EventOutcome</code> enumeration</li>
<li><code>reason</code> which is the reason string for all outcomes that are not <code>Accepted</code>.</li>
</ul>
<h3 id="project_stateget"><code>project_state.get</code></h3>
<p>The metric is referred in code as: <code>RelayCounters::ProjectStateGet</code>.</p>
<p>Counts the number of times a project state lookup is done. This includes requests
for projects that are cached and requests for projects that are not yet cached.
All requests that return a  <code>EventAction::Accept</code> i.e. are not rate limited (on
the fast path) or are discarded because we know the project is disabled or invalid
will be counted.</p>
<h3 id="project_staterequest"><code>project_state.request</code></h3>
<p>The metric is referred in code as: <code>RelayCounters::ProjectStateRequest</code>.</p>
<p>Counts the number of project state http requests. Note that a project state HTTP request
typically contains a number of projects (the project state requests are batched).</p>
<h3 id="project_cachehit"><code>project_cache.hit</code></h3>
<p>The metric is referred in code as: <code>RelayCounters::ProjectCacheHit</code>.</p>
<p>Counts the number of times a request for a project is already present, this effectively
represents the fraction of <code>project_state.get</code> that will <strong>not</strong> result in a ProjectState
request.</p>
<h3 id="project_cachemiss"><code>project_cache.miss</code></h3>
<p>The metric is referred in code as: <code>RelayCounters::ProjectCacheMiss</code>.</p>
<p>Counts the number of times a request for a project is not already present.
<code>project_state.get</code> = <code>project_cache.miss</code> + <code>project_cache.hit</code>.
Requests that are generating a cache hit will be queued and batched and eventually will
generate a <code>project_state.request</code>.</p>
<h3 id="project_idrequest"><code>project_id.request</code></h3>
<p>The metric is referred in code as: <code>RelayCounters::ProjectIdRequest</code>.</p>
<p>Counts the number of requests for the  ProjectId (the timing is tracked
by <code>project_id.request.duration</code>). Note that ProjectIdRequests happen only for the legacy
endpoint that does not specify the project id in the url, for the new endpoints the
project id is extracted from the url path. Only projects with the id not already fetched
are counted. Once the ProjectId is successfully cached it will be retained indefinitely.</p>
<h3 id="serverstarting"><code>server.starting</code></h3>
<p>The metric is referred in code as: <code>RelayCounters::ServerStarting</code>.</p>
<p>Counts the number of times Relay started.
This can be used to track unwanted restarts due to crashes or termination.</p>
<h3 id="processingeventproduced"><code>processing.event.produced</code></h3>
<p><strong>Note</strong>: This metric is emitted only when Relay is built with the <code>processing</code> feature.</p>
<p>The metric is referred in code as: <code>RelayCounters::ProcessingEventProduced</code>.</p>
<p>Counts the number of messages placed on the Kafka queue. When Relay operates with processing
enabled and a message is successfully processed each message will generate an event on the
Kafka queue and zero or more attachments. The counter has an  <code>event_type</code> tag which is set to
either <code>event</code> or <code>attachment</code> representing the type of message produced on the Kafka queue.</p>
<h3 id="eventprotocol"><code>event.protocol</code></h3>
<p>The metric is referred in code as: <code>RelayCounters::EventProtocol</code>.</p>
<p>Counts the number of events that hit any of the Store like endpoints (Store, Security,
MiniDump, Unreal). The events are counted before they are rate limited , filtered or
processed in any way. The counter has a <code>version</code> tag that tracks the message event
protocol version.</p>
<h3 id="requests"><code>requests</code></h3>
<p>The metric is referred in code as: <code>RelayCounters::Requests</code>.</p>
<p>Counts the number of requests reaching Relay.</p>
<h3 id="responsesstatus_codes"><code>responses.status_codes</code></h3>
<p>The metric is referred in code as: <code>RelayCounters::ResponsesStatusCodes</code>.</p>
<p>Counts the number of requests that have finished during the current interval.
The counter has the following tags:</p>
<ul>
<li><code>status_code</code> The HTTP status code number.</li>
<li><code>method</code> The HTTP method used in the request in uppercase.</li>
<li><code>route</code> Unique dashed identifier of the endpoint.</li>
</ul>
<h3 id="project_cacheeviction"><code>project_cache.eviction</code></h3>
<p>The metric is referred in code as: <code>RelayCounters::EvictingStaleProjectCaches</code>.</p>
<p>We are scanning our in-memory project cache for stale entries. This counter is incremented
before doing the expensive operation.</p>
                
                  
                
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../project-config/" title="Project Configuration" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Project Configuration
              </span>
            </div>
          </a>
        
        
          <a href="../pii-config/" title="PII Configuration" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                PII Configuration
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org" target="_blank" rel="noopener">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.c33a9706.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
        <script src="https://unpkg.com/mermaid@7.1.2/dist/mermaid.min.js"></script>
      
    
  </body>
</html>